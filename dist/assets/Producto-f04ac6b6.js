import{p as D}from"./ProductoService-6fc20d02.js";import{_ as J,r as s,u as Q,d as X,e as u,o as w,c as x,a as l,b as i,f as n,F,i as N,t as M,n as Z,j as R,g as $,k as ee,p as oe,l as te}from"./index-8262ac01.js";import{C as le}from"./CategoriaService-82341508.js";const ae={setup(){const c=s([]),t=s([]),U=s(0),e=Q(),I=s(),V=s(!1),b=s(!1),r=s(!1),_=s(!1),d=s({}),y=s(),m=s({global:{value:null,matchMode:ee.CONTAINS}}),C=s(!1),T=s([{label:"INSTOCK",value:"instock"},{label:"LOWSTOCK",value:"lowstock"},{label:"OUTOFSTOCK",value:"outofstock"}]),P=s(!1),S=s(0),p=s({}),o=a=>{if(a)return a.toLocaleString("en-US",{style:"currency",currency:"USD"})},h=()=>{d.value={},C.value=!1,b.value=!0},L=a=>{U.value=a.id,V.value=!0},O=()=>{b.value=!1,C.value=!1},B=async()=>{C.value=!0,d.value.nombre.trim()&&(d.value.id?(await D.modificar(d.value.id,d.value),k(),e.add({severity:"success",summary:"Successful",detail:"Producto Actualizado",life:3e3})):(await D.guardar(d.value),k(),e.add({severity:"success",summary:"Producto Registrado",detail:"Se ha registrado el producto",life:3e3})),b.value=!1,d.value={})},z=a=>{d.value={...a},b.value=!0},E=a=>{d.value=a,r.value=!0},q=async a=>{await D.eliminar(a),r.value=!1,d.value={},k(),e.add({severity:"success",summary:"Successful",detail:"Product Eliminado",life:3e3})},A=a=>{let v=-1;for(let g=0;g<c.value.length;g++)if(c.value[g].id===a){v=g;break}return v},K=()=>{let a="";for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",g=0;g<5;g++)a+=v.charAt(Math.floor(Math.random()*v.length));return a},j=()=>{I.value.exportCSV()},G=()=>{_.value=!0},H=()=>{c.value=c.value.filter(a=>!y.value.includes(a)),_.value=!1,y.value=null,e.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})},W=a=>{p.value=a,k()};X(async()=>{P.value=!0,p.value={first:0,rows:I.value.rows,sortField:null,sortOrder:null,filters:m.value},k(),Y()});const k=async()=>{try{P.value=!0;const{data:a}=await D.listar(p.value.page?p.value.page+1:1,p.value.rows);c.value=a.rows,S.value=a.count,P.value=!1}catch(a){console.log("Error: ",a)}},Y=async()=>{try{const{data:a}=await le.listarCategoria();t.value=a}catch{}};return{dt:I,products:c,categorias:t,productDialog:b,deleteProductDialog:r,deleteProductsDialog:_,product:d,totalRecords:S,loading:P,onPage:W,selectedProducts:y,filters:m,submitted:C,statuses:T,formatCurrency:o,openNew:h,hideDialog:O,saveProduct:B,editProduct:z,subirImagenServidor:async a=>{try{console.log(a.files);let v=new FormData;v.append("imagen",a.files[0]),await D.actualizarImagen(U.value,v),V.value=!1,k()}catch(v){console.log(v)}},confirmDeleteProduct:E,deleteProduct:q,findIndexById:A,createId:K,exportCSV:j,confirmDeleteSelected:G,deleteSelectedProducts:H,openModalImagen:L,displayModal:V}}},f=c=>(oe("data-v-6e534342"),c=c(),te(),c),ie={class:"card"},re={class:"table-header flex flex-column md:flex-row md:justiify-content-between"},se=f(()=>i("h5",{class:"mb-2 md:m-0 p-as-md-center"},"Gestión Productos",-1)),ne={class:"p-input-icon-left"},de=f(()=>i("i",{class:"pi pi-search"},null,-1)),ce=["src","alt"],ue={class:"field"},me=f(()=>i("label",{for:"nombre"},"Nombre",-1)),pe={key:0,class:"p-error"},ve={class:"field"},fe=f(()=>i("label",{for:"description"},"Descripcion",-1)),be={class:"field"},ge=f(()=>i("label",{class:"mb-3"},"Categoria",-1)),_e={class:"formgrid grid"},ye={for:"category1"},Ce={class:"formgrid grid"},Pe={class:"field col"},he=f(()=>i("label",{for:"price"},"Precio",-1)),ke={class:"field col"},we=f(()=>i("label",{for:"quantity"},"Cantidad",-1)),xe={class:"confirmation-content"},Se=f(()=>i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),De={key:0},Ie={class:"confirmation-content"},Ve=f(()=>i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ue={key:0},Te=f(()=>i("p",null,"Arrastrar imagenes aquí.",-1));function Ne(c,t,U,e,I,V){const b=u("Toast"),r=u("Button"),_=u("FileUpload"),d=u("Toolbar"),y=u("InputText"),m=u("Column"),C=u("DataTable"),T=u("Textarea"),P=u("RadioButton"),S=u("InputNumber"),p=u("Dialog");return w(),x(F,null,[l(b),i("div",null,[i("div",ie,[l(d,{class:"mb-4"},{start:n(()=>[l(r,{label:"Nuevo",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:e.openNew},null,8,["onClick"]),l(r,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:e.confirmDeleteSelected,disabled:!e.selectedProducts||!e.selectedProducts.length},null,8,["onClick","disabled"])]),end:n(()=>[l(_,{mode:"basic",accept:"image/*",maxFileSize:1e6,label:"Import",chooseLabel:"Importar",class:"mr-2 inline-block"}),l(r,{label:"Exportar",icon:"pi pi-upload",class:"p-button-help",onClick:t[0]||(t[0]=o=>e.exportCSV(o))})]),_:1}),l(C,{ref:"dt",value:e.products,lazy:!0,selection:e.selectedProducts,"onUpdate:selection":t[2]||(t[2]=o=>e.selectedProducts=o),dataKey:"id",paginator:!0,rows:10,filters:e.filters,totalRecords:e.totalRecords,loading:e.loading,onPage:t[3]||(t[3]=o=>e.onPage(o)),paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll"},{header:n(()=>[i("div",re,[se,i("span",ne,[de,l(y,{modelValue:e.filters.global.value,"onUpdate:modelValue":t[1]||(t[1]=o=>e.filters.global.value=o),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:n(()=>[l(m,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),l(m,{field:"id",header:"ID",sortable:!0,style:{"min-width":"2rem"}}),l(m,{field:"nombre",header:"NOMBRE",sortable:!0,style:{"min-width":"8rem"}}),l(m,{header:"Image"},{body:n(o=>[i("img",{src:`http://127.0.0.1:3000/imagenes/${o.data.imagen}`,alt:o.data.imagen,class:"product-image"},null,8,ce)]),_:1}),l(m,{field:"price",header:"Precio",sortable:!0,style:{"min-width":"4rem"}},{body:n(o=>[N(M(e.formatCurrency(o.data.precio)),1)]),_:1}),l(m,{field:"Categorium.nombre",header:"Categoria",sortable:!0,style:{"min-width":"10rem"}}),l(m,{exportable:!1,style:{"min-width":"8rem"}},{body:n(o=>[l(r,{icon:"pi pi-image",onClick:h=>e.openModalImagen(o.data)},null,8,["onClick"]),l(r,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:h=>e.editProduct(o.data)},null,8,["onClick"]),l(r,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning",onClick:h=>e.confirmDeleteProduct(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters","totalRecords","loading"])]),l(p,{visible:e.productDialog,"onUpdate:visible":t[9]||(t[9]=o=>e.productDialog=o),style:{width:"450px"},header:"Detalles de Producto",modal:!0,class:"p-fluid"},{footer:n(()=>[l(r,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:e.hideDialog},null,8,["onClick"]),l(r,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:e.saveProduct},null,8,["onClick"])]),default:n(()=>[i("div",ue,[me,l(y,{id:"nombre",modelValue:e.product.nombre,"onUpdate:modelValue":t[4]||(t[4]=o=>e.product.nombre=o),modelModifiers:{trim:!0},required:"true",autofocus:"",class:Z({"p-invalid":e.submitted&&!e.product.nombre})},null,8,["modelValue","class"]),e.submitted&&!e.product.nombre?(w(),x("small",pe,"Nombre es Obligatorio.")):R("",!0)]),i("div",ve,[fe,l(T,{id:"description",modelValue:e.product.descripcion,"onUpdate:modelValue":t[5]||(t[5]=o=>e.product.descripcion=o),required:"true",rows:"3",cols:"20"},null,8,["modelValue"])]),i("div",be,[ge,i("div",_e,[(w(!0),x(F,null,$(e.categorias,o=>(w(),x("div",{class:"field-radiobutton col-6",key:o.id},[l(P,{id:"category1",name:"category",value:o.id,modelValue:e.product.categoriaId,"onUpdate:modelValue":t[6]||(t[6]=h=>e.product.categoriaId=h)},null,8,["value","modelValue"]),i("label",ye,M(o.nombre),1)]))),128))])]),i("div",Ce,[i("div",Pe,[he,l(S,{id:"price",modelValue:e.product.precio,"onUpdate:modelValue":t[7]||(t[7]=o=>e.product.precio=o),mode:"currency",currency:"USD",locale:"en-US"},null,8,["modelValue"])]),i("div",ke,[we,l(S,{id:"quantity",modelValue:e.product.stock,"onUpdate:modelValue":t[8]||(t[8]=o=>e.product.stock=o),integeronly:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),l(p,{visible:e.deleteProductDialog,"onUpdate:visible":t[12]||(t[12]=o=>e.deleteProductDialog=o),style:{width:"450px"},header:"Confirmar Eliminación",modal:!0},{footer:n(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[10]||(t[10]=o=>e.deleteProductDialog=!1)}),l(r,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:t[11]||(t[11]=o=>e.deleteProduct(e.product.id))})]),default:n(()=>[i("div",xe,[Se,e.product?(w(),x("span",De,[N("¿Está seguro de eliminar el producto "),i("b",null,M(e.product.nombre),1),N("?")])):R("",!0)])]),_:1},8,["visible"]),l(p,{visible:e.deleteProductsDialog,"onUpdate:visible":t[14]||(t[14]=o=>e.deleteProductsDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[13]||(t[13]=o=>e.deleteProductsDialog=!1)}),l(r,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:e.deleteSelectedProducts},null,8,["onClick"])]),default:n(()=>[i("div",Ie,[Ve,e.product?(w(),x("span",Ue,"Are you sure you want to delete the selected products?")):R("",!0)])]),_:1},8,["visible"]),l(p,{header:"Header",visible:e.displayModal,"onUpdate:visible":t[16]||(t[16]=o=>e.displayModal=o),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"50vw"},modal:!0},{footer:n(()=>[l(r,{label:"Cerrar",icon:"pi pi-times",onClick:t[15]||(t[15]=o=>e.displayModal=!1),class:"p-button-text"})]),default:n(()=>[l(_,{customUpload:!0,onUploader:e.subirImagenServidor,multiple:!1,accept:"image/*",maxFileSize:1e6},{empty:n(()=>[Te]),_:1},8,["onUploader"])]),_:1},8,["visible"])])],64)}const Oe=J(ae,[["render",Ne],["__scopeId","data-v-6e534342"]]);export{Oe as default};
